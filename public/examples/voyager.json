{
  "version": "1.0.0",
  "sections": {
    "main": [
      {
        "answer": {}
      },
      {
        "record_call": {
          "format": "wav",
          "stereo": true
        }
      },
      {
        "ai": {
          "prompt": {
            "pom": [
              {
                "title": "Personality",
                "body": "You are Voyager, a friendly AI travel concierge who helps callers find and book flights. Keep it warm and brief \u2014 the occasional travel quip is welcome."
              },
              {
                "title": "Rules",
                "bullets": [
                  "This is a PHONE CALL. Keep every response to 1-2 short sentences.",
                  "Use airline names not codes ('Delta' not 'DL'). Say times naturally ('seven thirty PM' not '19:30').",
                  "Avoid commas in speech \u2014 use 'and' or 'or' instead. Keep sentences short and direct."
                ]
              }
            ],
            "contexts": {
              "default": {
                "steps": [
                  {
                    "name": "collect_profile",
                    "text": "Welcome the caller, then collect their profile.",
                    "valid_steps": [
                      "save_profile_step"
                    ],
                    "gather_info": {
                      "questions": [
                        {
                          "key": "first_name",
                          "question": "What is your first name?"
                        },
                        {
                          "key": "last_name",
                          "question": "What is your last name?"
                        },
                        {
                          "key": "date_of_birth",
                          "question": "What is your date of birth?",
                          "confirm": true,
                          "prompt": "Accept natural language but submit in YYYY-MM-DD format"
                        },
                        {
                          "key": "gender",
                          "question": "Are you male or female?",
                          "prompt": "Submit exactly MALE or FEMALE"
                        },
                        {
                          "key": "email",
                          "question": "What email should we send confirmations to?",
                          "confirm": true
                        },
                        {
                          "key": "seat_preference",
                          "question": "Do you prefer a window or aisle seat?",
                          "prompt": "Submit exactly WINDOW or AISLE"
                        },
                        {
                          "key": "cabin_preference",
                          "question": "What cabin class do you usually fly?",
                          "prompt": "Options are ECONOMY, PREMIUM_ECONOMY, BUSINESS, or FIRST"
                        },
                        {
                          "key": "home_airport",
                          "question": "What airport do you usually fly from?",
                          "confirm": true,
                          "prompt": "Accept city or airport name. Submit exactly what the caller says."
                        }
                      ],
                      "prompt": "First say: 'Welcome to Voyager! I'd love to help you book a flight.' Then collect the passenger's profile by asking each question. IMPORTANT: Only call gather_submit after the user has explicitly confirmed their answer with 'yes' or equivalent. Never call gather_submit speculatively or with confirmed_by_user set to false.",
                      "output_key": "profile_answers",
                      "completion_action": "next_step"
                    }
                  },
                  {
                    "name": "save_profile_step",
                    "text": "## Task\nSave the completed profile\n\n## Process\n- Call save_profile to create the passenger record\n- Profile data is in ${profile_answers}",
                    "functions": [
                      "save_profile"
                    ],
                    "valid_steps": [
                      "get_origin"
                    ]
                  },
                  {
                    "name": "get_origin",
                    "text": "## Task\nCollect the departure city or airport\n\n## Process\n- Check if ${origin.name} is already set from their home airport\n- If set, ask: 'Would you like to fly from ${origin.name} or somewhere else?'\n- If they confirm, proceed to next step\n- If they want a different airport or origin is not set, ask where they're flying from\n- Call resolve_location with their answer and location_type='origin'\n- Once the airport is confirmed, proceed to next step",
                    "step_criteria": "Origin airport confirmed and saved",
                    "functions": [
                      "resolve_location"
                    ],
                    "valid_steps": [
                      "get_destination",
                      "disambiguate_origin"
                    ]
                  },
                  {
                    "name": "disambiguate_origin",
                    "text": "## Task\nAsk the caller to choose between multiple origin airports\n\n## Process\n- Present the airports by name and city and ask which they prefer\n- Call select_airport with location_type='origin' and the chosen IATA code\n- If the caller says 'any', call select_airport with the first candidate",
                    "step_criteria": "Origin airport stored via select_airport",
                    "functions": [
                      "select_airport"
                    ],
                    "valid_steps": [
                      "get_destination"
                    ]
                  },
                  {
                    "name": "get_destination",
                    "text": "## Task\nCollect the arrival city or airport\n\n## Process\n- Ask where they're flying to \u2014 or if they already said a destination, call resolve_location right away with location_type='destination'\n- Once the airport is confirmed, proceed to next step",
                    "step_criteria": "Destination airport confirmed and saved",
                    "functions": [
                      "resolve_location"
                    ],
                    "valid_steps": [
                      "collect_trip_type",
                      "disambiguate_destination"
                    ]
                  },
                  {
                    "name": "disambiguate_destination",
                    "text": "## Task\nAsk the caller to choose between multiple destination airports\n\n## Process\n- Present the airports by name and ask which they prefer\n- Call select_airport with location_type='destination' and the chosen IATA code\n- If the caller says 'any', call select_airport with the first candidate",
                    "step_criteria": "Destination airport stored via select_airport",
                    "functions": [
                      "select_airport"
                    ],
                    "valid_steps": [
                      "collect_trip_type"
                    ]
                  },
                  {
                    "name": "collect_trip_type",
                    "text": "## Task\nAsk whether this is a round-trip or one-way flight\n\n## Process\n- Ask the caller: 'Is this a round-trip or one-way?'\n- Read back their answer and ask them to confirm it is correct\n- Call select_trip_type with trip_type 'round_trip' or 'one_way' and their confirmation",
                    "step_criteria": "Trip type confirmed and submitted via select_trip_type",
                    "functions": [
                      "select_trip_type"
                    ],
                    "valid_steps": [
                      "collect_booking"
                    ]
                  },
                  {
                    "name": "search_flights",
                    "text": "## Task\nRe-search flights (used only for error recovery \u2014 happy path searches inline via submit_cabin)\n\n## Process\n- Call search_flights to find available flights",
                    "step_criteria": "Flight search completed",
                    "functions": [
                      "search_flights"
                    ],
                    "valid_steps": [
                      "present_options",
                      "error_recovery"
                    ]
                  },
                  {
                    "name": "present_options",
                    "text": "## Task\nPresent up to 3 flight options and let the caller pick one\n\n## Process\n- Read each flight option from booking_state.flight_summaries \u2014 include airline, stops, times, duration, and price\n- Label them 'Option 1' then 'Option 2' then 'Option 3'\n- The caller prefers a ${global_data.passenger_profile.seat_preference} seat \u2014 mention it naturally when relevant\n- Ask which option they'd like or if they want to try different dates or a different route\n- When the caller picks one, call select_flight with that option_number\n- If caller wants different dates or a different route, call restart_search",
                    "step_criteria": "Caller selects an option via select_flight or requests new search via restart_search",
                    "functions": [
                      "select_flight",
                      "restart_search"
                    ],
                    "valid_steps": [
                      "confirm_price",
                      "collect_booking",
                      "get_origin"
                    ]
                  },
                  {
                    "name": "confirm_price",
                    "text": "## Task\nConfirm the live price on the selected flight\n\n## Process\n- Call get_flight_price to confirm the live fare",
                    "step_criteria": "Caller confirms or declines via confirm_booking or decline_booking",
                    "functions": [
                      "get_flight_price",
                      "confirm_booking",
                      "decline_booking"
                    ],
                    "valid_steps": [
                      "create_booking",
                      "present_options",
                      "error_recovery"
                    ]
                  },
                  {
                    "name": "create_booking",
                    "text": "## Task\nBook the flight and wrap up\n\n## Process\n- Call book_flight to create the reservation\n- Read the PNR back to the caller using the phonetic spelling provided\n- Thank them and say goodbye",
                    "step_criteria": "Booking created, PNR read back, call ending",
                    "functions": [
                      "book_flight"
                    ],
                    "valid_steps": [
                      "wrap_up",
                      "error_recovery"
                    ]
                  },
                  {
                    "name": "error_recovery",
                    "text": "## Task\nHandle booking failures, no results, and mid-flow changes\n\n## Process\n- Offer options: try different dates, a different route, or re-search the same route\n- If different dates: call restart_booking to go back to date collection\n- If different route: call restart_search with reason='different_route' to start over from origin\n- If same route: call search_flights to re-search with current settings",
                    "step_criteria": "Recovery action taken",
                    "functions": [
                      "search_flights",
                      "restart_booking",
                      "restart_search"
                    ],
                    "valid_steps": [
                      "present_options",
                      "collect_booking",
                      "get_origin"
                    ]
                  },
                  {
                    "name": "wrap_up",
                    "text": "## Task\nEnd the call\n\n## Process\n- Say a brief, warm goodbye: 'Thanks for flying with Voyager \u2014 have an amazing trip!'\n- End the call",
                    "functions": "none",
                    "valid_steps": []
                  },
                  {
                    "name": "collect_booking",
                    "text": "Search for flights.",
                    "valid_steps": [
                      "search_and_present"
                    ],
                    "gather_info": {
                      "questions": [
                        {
                          "key": "departure_date",
                          "question": "When would you like to depart?",
                          "confirm": true,
                          "prompt": "Accept natural language but submit in YYYY-MM-DD format. Must be a future date."
                        },
                        {
                          "key": "return_date",
                          "question": "When would you like to return?",
                          "confirm": true,
                          "prompt": "Check ${booking_state.trip_type}. If it is 'one_way', submit 'ONEWAY' immediately without asking the caller. Only ask 'When would you like to return?' if the trip type is 'round_trip'. Accept natural language but submit in YYYY-MM-DD format. Must be after departure date."
                        },
                        {
                          "key": "adults",
                          "question": "How many passengers?",
                          "type": "integer",
                          "prompt": "Must be 1-8 passengers"
                        },
                        {
                          "key": "cabin_class",
                          "question": "What cabin class would you like \u2014 you usually fly ${global_data.passenger_profile.cabin_preference}?",
                          "prompt": "Options: ECONOMY, PREMIUM_ECONOMY, BUSINESS, FIRST."
                        }
                      ],
                      "prompt": "Now let's plan your trip, ${global_data.passenger_profile.first_name}.",
                      "output_key": "booking_answers",
                      "completion_action": "next_step"
                    }
                  },
                  {
                    "name": "search_and_present",
                    "text": "## Task\nSearch for available flights\n\n## Process\n- Booking details are in ${booking_answers}\n- Call search_flights to find available flights",
                    "step_criteria": "Search completed",
                    "functions": [
                      "search_flights"
                    ],
                    "valid_steps": [
                      "present_options",
                      "error_recovery"
                    ]
                  }
                ]
              }
            },
            "top_p": 0.9,
            "temperature": 0.3
          },
          "post_prompt": {
            "text": "Summarize the conversation."
          },
          "post_prompt_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/post_prompt/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLnBvc3RfcHJvbXB0LjE3NzEzMzU0NjIuZDRjYTI4OWUuNDI5OGVjMTlmOGViMjZmNw%3D%3D",
          "SWAIG": {
            "functions": [
              {
                "function": "resolve_location",
                "description": "Resolve a spoken city or place name",
                "parameters": {
                  "type": "object",
                  "properties": {
                    "location_text": {
                      "type": "string",
                      "description": "The city, airport, or place name spoken by the caller"
                    },
                    "location_type": {
                      "type": "string",
                      "description": "Whether this is an 'origin' or 'destination'",
                      "enum": [
                        "origin",
                        "destination"
                      ]
                    },
                    "mode": {
                      "type": "string",
                      "description": "normal = resolve and change step (default). verify = resolve and return result without changing step.",
                      "enum": [
                        "normal",
                        "verify"
                      ]
                    }
                  },
                  "required": [
                    "location_text"
                  ]
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLnJlc29sdmVfbG9jYXRpb24uMTc3MTMzNTQ2Mi45Y2EwYzJlZi4wYzU2MzljOTM5MTc3YTIw"
              },
              {
                "function": "select_airport",
                "description": "Select an airport from the disambiguation candidates.",
                "parameters": {
                  "type": "object",
                  "properties": {
                    "location_type": {
                      "type": "string",
                      "description": "Whether this is an 'origin' or 'destination'",
                      "enum": [
                        "origin",
                        "destination"
                      ]
                    },
                    "iata_code": {
                      "type": "string",
                      "description": "The IATA code of the selected airport from the candidates list"
                    }
                  },
                  "required": [
                    "location_type",
                    "iata_code"
                  ]
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLnNlbGVjdF9haXJwb3J0LjE3NzEzMzU0NjIuOWM0MmMwM2MuZGI2ZjgwNmZmNzZlODI2OA%3D%3D"
              },
              {
                "function": "select_trip_type",
                "description": "Record whether this is a round-trip or one-way flight.",
                "parameters": {
                  "type": "object",
                  "properties": {
                    "trip_type": {
                      "type": "string",
                      "description": "round_trip or one_way",
                      "enum": [
                        "round_trip",
                        "one_way"
                      ]
                    },
                    "confirmed": {
                      "type": "boolean",
                      "description": "Set true only after the caller explicitly confirmed"
                    }
                  },
                  "required": [
                    "trip_type"
                  ]
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLnNlbGVjdF90cmlwX3R5cGUuMTc3MTMzNTQ2Mi4xZTU1NTJjNC5lNjAzMzIzMzZiZDMxZDRm"
              },
              {
                "function": "finalize_profile",
                "description": "Save the completed profile. Reads from profile_answers in global_data.",
                "parameters": {
                  "type": "object",
                  "properties": {},
                  "required": []
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLmZpbmFsaXplX3Byb2ZpbGUuMTc3MTMzNTQ2Mi5iZDM1OTI1NS5hYTM3ZTVjNTRmNzI1Yjhh"
              },
              {
                "function": "finalize_booking",
                "description": "Store the collected booking details. Reads from booking_answers in global_data.",
                "parameters": {
                  "type": "object",
                  "properties": {},
                  "required": []
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLmZpbmFsaXplX2Jvb2tpbmcuMTc3MTMzNTQ2Mi5iYTY4ODBiYi42OGZlYTFmNTkwMWNmNmI2"
              },
              {
                "function": "search_flights",
                "description": "Search for available flights and return up to 3 options.",
                "parameters": {
                  "type": "object",
                  "properties": {},
                  "required": []
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLnNlYXJjaF9mbGlnaHRzLjE3NzEzMzU0NjIuMWM5NGMxNTEuOTZkYzk1MTY1NDkxMGIzMQ%3D%3D"
              },
              {
                "function": "select_flight",
                "description": "Select one of the flight options returned by search_flights. Call this after the caller picks option 1, 2, or 3.",
                "parameters": {
                  "type": "object",
                  "properties": {
                    "option_number": {
                      "type": "integer",
                      "description": "The option number the caller chose",
                      "enum": [
                        1,
                        2,
                        3
                      ]
                    }
                  },
                  "required": [
                    "option_number"
                  ]
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLnNlbGVjdF9mbGlnaHQuMTc3MTMzNTQ2Mi5iYTFjZDRjOS4xOTRjZTBiNmYyMDgyY2U1"
              },
              {
                "function": "restart_search",
                "description": "Caller wants to change dates or route. Call this instead of select_flight.",
                "parameters": {
                  "type": "object",
                  "properties": {
                    "reason": {
                      "type": "string",
                      "description": "Why the caller wants to restart: 'different_dates' or 'different_route'",
                      "enum": [
                        "different_dates",
                        "different_route"
                      ]
                    }
                  },
                  "required": [
                    "reason"
                  ]
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLnJlc3RhcnRfc2VhcmNoLjE3NzEzMzU0NjIuNmFjOGIwMjMuOWIyYzhmMzQ1MTU1YmE5Mg%3D%3D"
              },
              {
                "function": "restart_booking",
                "description": "Restart the booking with new dates. Call from error recovery.",
                "parameters": {
                  "type": "object",
                  "properties": {},
                  "required": []
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLnJlc3RhcnRfYm9va2luZy4xNzcxMzM1NDYyLjAwNWY5YTUzLjBiNzdlZjVhY2NkMWM1MWU%3D"
              },
              {
                "function": "get_flight_price",
                "description": "Confirm the exact price for the flight selected via select_flight.",
                "parameters": {
                  "type": "object",
                  "properties": {},
                  "required": []
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLmdldF9mbGlnaHRfcHJpY2UuMTc3MTMzNTQ2Mi45ZmE0ZmRiZC4zNWVlOTNmMTNlMTJmYTJk"
              },
              {
                "function": "confirm_booking",
                "description": "Caller accepted the price \u2014 proceed to booking.",
                "parameters": {
                  "type": "object",
                  "properties": {},
                  "required": []
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLmNvbmZpcm1fYm9va2luZy4xNzcxMzM1NDYyLjNlYjg2NDAxLmU0MjNjOWM2ZjM4OTFlMWQ%3D"
              },
              {
                "function": "decline_booking",
                "description": "Caller declined the price \u2014 go back to flight options.",
                "parameters": {
                  "type": "object",
                  "properties": {},
                  "required": []
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLmRlY2xpbmVfYm9va2luZy4xNzcxMzM1NDYyLmUzYTYwMDJkLmE4NDZmNDg1MGYyZjgwODY%3D"
              },
              {
                "function": "book_flight",
                "description": "Book the confirmed flight and create a PNR.",
                "parameters": {
                  "type": "object",
                  "properties": {},
                  "required": []
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "fillers": {
                  "en-US": [
                    "Booking that for you now"
                  ]
                },
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLmJvb2tfZmxpZ2h0LjE3NzEzMzU0NjIuMGQ5Zjg2NjUuOTk1NjQ4YjRmMWZmMWI1MA%3D%3D"
              },
              {
                "function": "summarize_conversation",
                "description": "Generate a structured call summary. Called automatically when the conversation ends.",
                "parameters": {
                  "type": "object",
                  "properties": {
                    "summary": {
                      "type": "string",
                      "description": "Brief description of what happened during the call"
                    }
                  },
                  "required": [
                    "summary"
                  ]
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLnN1bW1hcml6ZV9jb252ZXJzYXRpb24uMTc3MTMzNTQ2Mi42ZTRkYWIzZC4yNGM3ODQwZDg0ZjAyZDVi"
              },
              {
                "function": "save_profile",
                "description": "Save profile and create passenger",
                "parameters": {
                  "type": "object",
                  "properties": {}
                },
                "wait_file": "https://briankwest.ngrok.io/sounds/typing.mp3",
                "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/?__token=NzhjZjMzMTgtNDNlZC00Y2FjLWFhMzgtOTZlMzNhNDk1ZmVhLnNhdmVfcHJvZmlsZS4xNzcxMzM1NDYyLmVlZDA0YTllLmIyOGZmOTRiN2QxMDJlNTU%3D"
              }
            ],
            "defaults": {
              "web_hook_url": "https://voyager:bee1pohfeiKahZiT@briankwest.ngrok.io/swml/swaig/"
            }
          },
          "params": {
            "ai_model": "gpt-oss-120b@groq.ai",
            "thinking_model": "gpt-oss-120b@groq.ai",
            "enable_thinking": true
          },
          "hints": [
            "Voyager",
            "IATA",
            "nonstop",
            "layover",
            "round trip"
          ],
          "languages": [
            {
              "name": "English",
              "code": "en-US",
              "voice": "azure.en-US-AvaNeural"
            }
          ],
          "global_data": {
            "passenger_profile": null,
            "is_new_caller": true,
            "caller_phone": "+19184249378"
          }
        }
      }
    ]
  }
}
